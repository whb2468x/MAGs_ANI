# PyOrthoANI åŸºå› ç»„ANIè®¡ç®—å·¥å…·

![Python Version](https://img.shields.io/badge/python-3.7%2B-blue)
![License](https://img.shields.io/badge/license-MIT-green)
![Last Commit](https://img.shields.io/github/last-commit/username/pyorthoani-tool)

ä¸€ä¸ªåŸºäºpyorthoaniçš„äº¤äº’å¼åŸºå› ç»„å¹³å‡æ ¸é…¸ä¸€è‡´æ€§(ANI)è®¡ç®—ä¸å¯è§†åŒ–å·¥å…·ï¼Œæ”¯æŒæ‰¹é‡å¤„ç†å’Œå¤šæ ¼å¼è¾“å‡ºã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ–¥ï¸ **äº¤äº’å¼ç•Œé¢**ï¼šå‹å¥½çš„å‘½ä»¤è¡Œäº¤äº’ä½“éªŒ
- ğŸ§¬ **å¤šæ ¼å¼æ”¯æŒ**ï¼šæ”¯æŒ.fa, .fasta, .fna, .ffnæ ¼å¼
- ğŸ“Š **æ™ºèƒ½å¯è§†åŒ–**ï¼šè‡ªåŠ¨ç”ŸæˆANIçƒ­å›¾å’Œç»Ÿè®¡æŠ¥å‘Š
- âš¡ **é«˜æ•ˆè®¡ç®—**ï¼šåˆ©ç”¨pyorthoaniè¿›è¡Œå¿«é€Ÿæ¯”å¯¹
- ğŸ“‚ **çµæ´»è¾“å‡º**ï¼šæ”¯æŒè‡ªå®šä¹‰è¾“å‡ºç›®å½•
- ğŸ›¡ï¸ **å¥å£®æ€§**ï¼šå®Œå–„çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—ç³»ç»Ÿ

## å®‰è£…æŒ‡å—

### å‰ç½®è¦æ±‚

- Python 3.12+
- blast
- pyorthoani (å»ºè®®å®‰è£…å‰åˆ›å»ºæ–°çš„ç¯å¢ƒï¼Œå…ˆå®‰è£…blast)
- ä»¥ä¸‹PythonåŒ…ï¼š
  - numpy
  - pandas
  - matplotlib
  - seaborn
  - tqdm

### å®‰è£…æ­¥éª¤

1. å…‹éš†ä»“åº“ï¼š

   ```bash
   git clone https://github.com/whb2468/pyorthoani-tool.git
   cd pyorthoani-tool
   ```

2. åˆ›å»ºcondaç¯å¢ƒï¼ˆæ¨èï¼‰ï¼š
  
   ```bash
   conda create -n pyorthoani
   conda activate pyorthoani
   ```

3. å®‰è£…ä¾èµ–

   ```bash
   conda install balst
   pip install pyorthoani
   conda install numpy pandas matplotlib seaborn tqdm
   ```

## ä½¿ç”¨è¯´æ˜

1. åŸºæœ¬ç”¨æ³•

    ```bash
    python3 pyorthoani.py
    ```

    ç¨‹åºå°†å¼•å¯¼æ‚¨å®Œæˆä»¥ä¸‹æ­¥éª¤ï¼š
  
    è¾“å…¥åŸºå› ç»„æ–‡ä»¶ç›®å½•
    é€‰æ‹©è¾“å‡ºç›®å½•
    é¢„è§ˆæ£€æµ‹åˆ°çš„åŸºå› ç»„æ–‡ä»¶
    ç¡®è®¤å¼€å§‹è®¡ç®—

2. å‘½ä»¤è¡Œé€‰é¡¹
  
    å‚æ•°  æè¿°    é»˜è®¤å€¼
    -i, --input   æŒ‡å®šè¾“å…¥ç›®å½•    å½“å‰ç›®å½•
    -o, --output  æŒ‡å®šè¾“å‡ºç›®å½•    å½“å‰ç›®å½•
    -q, --quiet   é™é»˜æ¨¡å¼ï¼ˆå‡å°‘è¾“å‡ºï¼‰    False
  
    ç¤ºä¾‹:

    ```bash
    python3 pyorthoani.py -i ./genomes -o ./results
    ```

3. è¾“å‡ºæ–‡ä»¶è¯´æ˜
  
    æ–‡ä»¶å   æè¿°
    ani_pairs.csv   æ‰€æœ‰åŸºå› ç»„å¯¹çš„ANIç»“æœ
    ani_matrix.csv  ANIçŸ©é˜µ(CSVæ ¼å¼)
    ani_stats.txt   ç»Ÿè®¡æ‘˜è¦(æœ€å°å€¼/æœ€å¤§å€¼/å¹³å‡å€¼)
    ani_heatmap.png ANIçƒ­å›¾å¯è§†åŒ–
    ani_calculation.log   è¯¦ç»†è¿è¡Œæ—¥å¿—

## ç»“æœè§£è¯»

1. ANIå€¼è¯´æ˜
  
    95%ä»¥ä¸Šï¼šé€šå¸¸è®¤ä¸ºå±äºåŒä¸€ç‰©ç§
    90-95%ï¼šåŒä¸€å±çš„ä¸åŒç‰©ç§
    90%ä»¥ä¸‹ï¼šä¸åŒå±çš„å¾®ç”Ÿç‰©

2. ANIçƒ­å›¾ç¤ºä¾‹
    ![alt text](ani_heatmap.png)

3. çƒ­å›¾é¢œè‰²è¯´æ˜ï¼š

    çº¢è‰²ï¼šé«˜ç›¸ä¼¼åº¦ï¼ˆ90-100%ï¼‰
    é»„è‰²ï¼šä¸­ç­‰ç›¸ä¼¼åº¦(70-90%)
    ç™½è‰²ï¼šä½ç›¸ä¼¼åº¦(<70%)æˆ–è®¡ç®—å¤±è´¥

## å¸¸è§é—®é¢˜

1. è®¡ç®—è¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯æ€ä¹ˆåŠï¼Ÿ
    æ£€æŸ¥ani_calculation.logæ–‡ä»¶è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯ã€‚å¸¸è§é—®é¢˜ï¼š
     pyorthoaniæœªæ­£ç¡®å®‰è£…
     è¾“å…¥æ–‡ä»¶ä¸æ˜¯æœ‰æ•ˆçš„FASTAæ ¼å¼
     æ–‡ä»¶æƒé™é—®é¢˜

2. å¦‚ä½•å¤„ç†å¤§é‡åŸºå› ç»„æ–‡ä»¶ï¼Ÿ
    å¯¹äºè¶…è¿‡50ä¸ªåŸºå› ç»„ï¼š
    ä½¿ç”¨--quietæ¨¡å¼å‡å°‘è¾“å‡º
    è€ƒè™‘åˆ†æ‰¹å¤„ç†
    ç¡®ä¿æœ‰è¶³å¤Ÿçš„å†…å­˜(å»ºè®®â‰¥16GB)

3. ä¸ºä»€ä¹ˆæœ‰äº›æ¯”å¯¹ç»“æœæ˜¯0ï¼Ÿ
    è¿™è¡¨ç¤ºä¸¤ä¸ªåŸºå› ç»„é—´å‡ ä¹ä¸å­˜åœ¨ä¿å®ˆåŒºåŸŸï¼Œå¯èƒ½æ˜¯ï¼š
    è¿›åŒ–è·ç¦»å¾ˆè¿œçš„åŸºå› ç»„
    é«˜åº¦é‡æ’çš„åŸºå› ç»„
    è¾“å…¥æ–‡ä»¶è´¨é‡é—®é¢˜

## æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. é¢„å¤„ç†åŸºå› ç»„æ–‡ä»¶ï¼š
    ç¡®ä¿æ–‡ä»¶æ²¡æœ‰å¤šä½™çš„ç©ºæ ¼æˆ–ç‰¹æ®Šå­—ç¬¦
    ç»Ÿä¸€ä½¿ç”¨.faä½œä¸ºæ‰©å±•å

2. å¹¶è¡Œè®¡ç®—ï¼š
    ä¿®æ”¹è„šæœ¬æ·»åŠ å¤šè¿›ç¨‹æ”¯æŒ:

    ```python
    from multiprocessing import Pool
    ```

3. ä½¿ç”¨SSDå­˜å‚¨ï¼š
    å¯ä»¥æ˜¾è‘—æé«˜I/Oå¯†é›†å‹æ“ä½œçš„æ€§èƒ½

## å¼€å‘è€…æŒ‡å—

é¡¹ç›®ç»“æ„
 pyorthoani-tool/
 â”œâ”€â”€ pyorthoani_pro.py      # ä¸»ç¨‹åº
 â”œâ”€â”€ requirements.txt       # ä¾èµ–åˆ—è¡¨
 â”œâ”€â”€ LICENSE
 â””â”€â”€ README.md
æ‰©å±•åŠŸèƒ½
 æ·»åŠ æ–°çš„æ–‡ä»¶æ ¼å¼æ”¯æŒï¼š
 ä¿®æ”¹supported_extåˆ—è¡¨
 æ·»åŠ ç›¸åº”çš„éªŒè¯å‡½æ•°
 é›†æˆå…¶ä»–ANIå·¥å…·ï¼š
 å¯ä»¥æ·»åŠ FastANIä½œä¸ºå¤‡é€‰å¼•æ“
 å¢åŠ ç½‘ç»œåŠŸèƒ½ï¼š
 æ·»åŠ è¿œç¨‹æ–‡ä»¶ä¸‹è½½æ”¯æŒ
 ç»“æœè‡ªåŠ¨ä¸Šä¼ åŠŸèƒ½

## è´¡çŒ®æŒ‡å—

 æ¬¢è¿æäº¤Issueå’ŒPull Requestã€‚è¯·éµå¾ªä»¥ä¸‹è§„èŒƒï¼š
 ä½¿ç”¨Googleé£æ ¼ä»£ç æ³¨é‡Š
 ä¿æŒä»£ç é£æ ¼ä¸€è‡´
 æ–°åŠŸèƒ½éœ€é™„å¸¦å•å…ƒæµ‹è¯•

## è®¸å¯è¯

 æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ - è¯¦æƒ…è¯·è§LICENSEæ–‡ä»¶ã€‚
